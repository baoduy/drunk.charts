# drunk.dev Domain-Specific Gateway
# Creates a Gateway specifically for *.drunk.dev domain with cert-manager integration
#
# Prerequisites:
# Install cert-manager if not already installed:
#   helm install cert-manager oci://quay.io/jetstack/charts/cert-manager \
#     --version v1.19.1 \
#     --namespace cert-manager \
#     --create-namespace \
#     --set crds.enabled=true

gatewayClass:
  enabled: true
  name: nginx
  controllerName: gateway.nginx.org/nginx-gateway-controller

domains:
  - name: drunk-dev
    enabled: true
    gatewayClassName: nginx
    annotations:
      # cert-manager will automatically create Certificate resource
      cert-manager.io/cluster-issuer: letsencrypt-prod

    listeners:
      - name: http
        protocol: HTTP
        port: 80
        hostname: "*.drunk.dev"
        allowedRoutes:
          namespaces:
            from: Same # Only allow HTTPRoutes from same namespace

      - name: https
        protocol: HTTPS
        port: 443
        hostname: "*.drunk.dev"
        tls:
          mode: Terminate
          certificateRefs:
            - kind: Secret
              name: drunk-dev-tls # cert-manager will create this
        allowedRoutes:
          namespaces:
            from: Same

certManager:
  enabled: false # Assumes cert-manager is already installed
