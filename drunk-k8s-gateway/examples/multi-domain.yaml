# Multi-Domain Configuration
# Creates separate Gateways for different domains/environments
#
# Prerequisites:
# Install cert-manager if using automatic TLS:
#   helm install cert-manager oci://quay.io/jetstack/charts/cert-manager \
#     --version v1.19.1 \
#     --namespace cert-manager \
#     --create-namespace \
#     --set crds.enabled=true

gatewayClass:
  enabled: true
  name: nginx
  controllerName: gateway.nginx.org/nginx-gateway-controller

# Multiple domain-specific Gateways
domains:
  # Production domain
  - name: production
    enabled: true
    gatewayClassName: nginx
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
    labels:
      environment: production
    listeners:
      - name: https
        protocol: HTTPS
        port: 443
        hostname: "*.prod.drunk.dev"
        tls:
          mode: Terminate
          certificateRefs:
            - kind: Secret
              name: prod-drunk-dev-tls
        allowedRoutes:
          namespaces:
            from: Same

  # Staging domain
  - name: staging
    enabled: true
    gatewayClassName: nginx
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-staging
    labels:
      environment: staging
    listeners:
      - name: https
        protocol: HTTPS
        port: 443
        hostname: "*.staging.drunk.dev"
        tls:
          mode: Terminate
          certificateRefs:
            - kind: Secret
              name: staging-drunk-dev-tls
        allowedRoutes:
          namespaces:
            from: Same

  # Development domain
  - name: development
    enabled: true
    gatewayClassName: nginx
    labels:
      environment: development
    listeners:
      - name: http
        protocol: HTTP
        port: 80
        hostname: "*.dev.drunk.dev"
        allowedRoutes:
          namespaces:
            from: Same

certManager:
  enabled: false # Assumes cert-manager is already installed
