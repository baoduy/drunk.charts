suite: test TLS secrets
templates:
  - tls-secrets.yaml
tests:
  - it: should create a TLS secret when enabled
    set:
      proxies:
        example:
          backendTlsCert:
            crt: "example-cert"
            key: "example-key"
            ca: "example-ca"
    asserts:
      - isKind:
          of: Secret
      - equal:
          path: metadata.name
          value: "tls-example-ingress-proxy"

  - it: should default to enabled if the enabled flag is not specified
    set:
      proxies:
        example:
          backendTlsCert:
            crt: "example-cert"
            key: "example-key"
    asserts:
      - isKind:
          of: Secret
      - equal:
          path: metadata.name
          value: "tls-example-ingress-proxy"
